(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}},function(e,t,r){e.exports=r(5)},function(e,t){e.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},function(e,t){function r(e,t,r,n,i,o,a){try{var s=e[o](a),h=s.value}catch(e){return void r(e)}s.done?t(h):Promise.resolve(h).then(n,i)}e.exports=function(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var a=e.apply(t,n);function s(e){r(a,i,o,s,h,"next",e)}function h(e){r(a,i,o,s,h,"throw",e)}s(void 0)}))}}},function(e,t,r){var n=function(e){"use strict";var t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",o=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function s(e,t,r,n){var i=t&&t.prototype instanceof u?t:u,o=Object.create(i.prototype),a=new R(n||[]);return o._invoke=function(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return H()}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var s=y(a,r);if(s){if(s===c)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=h(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===c)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}(e,r,a),o}function h(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var c={};function u(){}function l(){}function d(){}var p={};p[i]=function(){return this};var E=Object.getPrototypeOf,f=E&&E(E(b([])));f&&f!==t&&r.call(f,i)&&(p=f);var v=d.prototype=u.prototype=Object.create(p);function w(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function m(e,t){var n;this._invoke=function(i,o){function a(){return new t((function(n,a){!function n(i,o,a,s){var c=h(e[i],e,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==typeof l&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}(i,o,n,a)}))}return n=n?n.then(a,a):a()}}function y(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,y(e,t),"throw"===t.method))return c;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}var n=h(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,c;var i=n.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,c):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,c)}function g(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(g,this),this.reset(!0)}function b(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:H}}function H(){return{value:void 0,done:!0}}return l.prototype=v.constructor=d,d.constructor=l,d[a]=l.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===l||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,a in e||(e[a]="GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},w(m.prototype),m.prototype[o]=function(){return this},e.AsyncIterator=m,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var a=new m(s(t,r,n,i),o);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},w(v),v[a]="Generator",v[i]=function(){return this},v.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=b,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var s=r.call(o,"catchLoc"),h=r.call(o,"finallyLoc");if(s&&h){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,c):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),c},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),c}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;T(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:b(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),c}},e}(e.exports);try{regeneratorRuntime=n}catch(e){Function("r","regeneratorRuntime = r")(n)}},function(e,t,r){"use strict";r.r(t);var n=r(2),i=r.n(n),o=r(3),a=r.n(o),s=r(4),h=r.n(s),c=r(0),u=r.n(c),l=r(1),d=r.n(l);var p,E=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;u()(this,e),this.container=t?document.querySelector(t):null,this.width=this.container?this.container.offsetWidth:window.innerWidth,this.height=this.container?this.container.offsetHeight:window.innerHeight,this.dev=r,this.scene=new THREE.Scene,this.scene.position.set(0,-50,0),this.camera=this.initCamera(n),this.rotateY=(new THREE.Matrix4).makeRotationY(.005),this.initLight(),this.initRenderer(),this.initTexture(),this.initFloor(n),r&&(this.stats(),this.AxesHelper=new THREE.AxesHelper(300),this.AxesHelper.position.set(0,0,0),this.scene.add(this.AxesHelper)),this.render(),this.initControls(),this.animationID=this.animate(),window.addEventListener("resize",this.onResize.bind(this),!1),window.addEventListener("dblclick",this.injectHandler.bind(this,i),!1)}return d()(e,[{key:"initCamera",value:function(e){var t=new THREE.PerspectiveCamera(50,this.width/this.height,1,1e4);return t.position.set(0,15,200),t.lookAt(this.scene.position),t.updateMatrix(),t}},{key:"initLight",value:function(){this.dircLight=new THREE.DirectionalLight(16777215),this.dircLight.position.set(300,400,200),this.scene.add(this.dircLight);var e=new THREE.HemisphereLight(12403,169879,.75);e.position.set(.5,1,.75),this.scene.add(e)}},{key:"initFloor",value:function(e){var t=new THREE.BoxGeometry(300,0,250),r=new THREE.MeshLambertMaterial({color:16777215,map:this.floorTexture,transparent:!0});this.floor=new THREE.Mesh(t,r),this.floor.position.set(0,-1,10),this.scene.add(this.floor)}},{key:"initTexture",value:function(){var e,t,r=this;this.floorTexture=(e="images/floor.png",t=function(){r.render()},(new THREE.TextureLoader).load(e,()=>{t()})),this.floorTexture.wrapS=THREE.RepeatWrapping,this.floorTexture.wrapT=THREE.RepeatWrapping,this.floorTexture.repeat.set(1,1)}},{key:"initRenderer",value:function(){this.renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!0}),this.renderer.setSize(this.width,this.height),this.renderer.setClearColor("#0b0c0f"),this.container?this.container.appendChild(this.renderer.domElement):document.body.appendChild(this.renderer.domElement),this.labelRenderer=new THREE.CSS2DRenderer,this.labelRenderer.setSize(this.width,this.height),this.labelRenderer.domElement.style.position="absolute",this.labelRenderer.domElement.style.top=0,this.container?this.container.appendChild(this.labelRenderer.domElement):document.body.appendChild(this.labelRenderer.domElement)}},{key:"initWave",value:function(){for(var e=2*Math.PI,t=new THREE.PointCloudMaterial({color:"#0063f5",program:function(t){t.beginPath(),t.arc(0,0,16,0,e),t.fill()}}),r=0,n=0;n<this.AMOUNTX;n++)for(var i=0;i<this.AMOUNTY;i++)this.particle=this.particles[r++]=new THREE.Sprite(t),this.particle.position.x=n*this.SEPARATION-this.AMOUNTX*this.SEPARATION/2,this.particle.position.z=i*this.SEPARATION-this.AMOUNTY*this.SEPARATION/2,this.scene.add(this.particle)}},{key:"render",value:function(){TWEEN.update(),this.camera.applyMatrix4(this.rotateY),this.renderer.render(this.scene,this.camera),this.labelRenderer.render(this.scene,this.camera)}},{key:"initControls",value:function(){this.controls=new THREE.OrbitControls(this.camera),this.controls.addEventListener("change",this.render.bind(this)),this.controls.maxDistance=2e3,this.controls.maxPolarAngle=1.5,this.controls.minPolarAngle=.5,this.controls.enableZoom=!1}},{key:"onResize",value:function(){var e=this.container?this.container.offsetWidth:window.innerWidth,t=this.container?this.container.offsetHeight:window.innerHeight;this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t),this.labelRenderer.render(this.scene,this.camera),this.labelRenderer.setSize(e,t)}},{key:"stats",value:function(){this.stats=new Stats,this.container?this.container.appendChild(this.stats.dom):document.body.appendChild(this.stats.dom)}},{key:"animate",value:function(){return this.render(),this.dev&&this.stats.update(),requestAnimationFrame(this.animate.bind(this))}},{key:"injectHandler",value:function(e,t){var r=window.innerWidth,n=window.innerHeight;t.preventDefault();var i=new THREE.Vector3(t.clientX/r*2-1,-t.clientY/n*2+1,.5);i=i.unproject(this.camera);var o=new THREE.Raycaster(this.camera.position,i.sub(this.camera.position).normalize()).intersectObjects(this.scene.children,!0)[0].object;e&&e instanceof Function&&e(o.parent),"front-door"===o.name&&(0==o.parent.rotation.y?new TWEEN.Tween(o.parent.rotation).to({y:.6*Math.PI},1500).easing(TWEEN.Easing.Elastic.Out).start():new TWEEN.Tween(o.parent.rotation).to({y:0},300).start(),this.controls.update()),"back-door"===o.name&&(0==o.parent.rotation.y?new TWEEN.Tween(o.parent.rotation).to({y:.6*Math.PI},1500).easing(TWEEN.Easing.Elastic.Out).start():new TWEEN.Tween(o.parent.rotation).to({y:0},300).start(),this.controls.update()),"server"!==o.name&&"switch"!==o.name||(0===o.parent.position.z?new TWEEN.Tween(o.parent.position).to({z:o.parent.position.z+30},500).easing(TWEEN.Easing.Elastic.Out).start():new TWEEN.Tween(o.parent.position).to({z:o.parent.position.z-30},500).easing(TWEEN.Easing.Elastic.Out).start(),this.controls.update()),this.render()}},{key:"destroyed",value:function(){window.cancelAnimationFrame(this.animationID),this.animationID=null,this.scene=null,this.camera=null,this.particle=null,this.particles=[],this.dircLight=null,this.dev=null,this.controls=null,window.removeEventListener("resize",(function(){})),window.removeEventListener("dblclick",(function(){})),this.container?(this.container.removeChild(this.renderer.domElement),this.container.removeChild(this.labelRenderer.domElement)):(document.body.removeChild(this.renderer.domElement),document.body.removeChild(this.labelRenderer.domElement)),this.container=null,this.renderer=null,this.labelRenderer=null}}]),e}(),f=31487,v="rgba(255, 108, 108, 1)",w="rgba(0, 122, 255, 1)",m=function(){function e(t){u()(this,e),this.options=t,this.x=t.x,this.y=t.y,this.z=t.z,this.group=this.render()}return d()(e,[{key:"render",value:function(){var e=new THREE.Group;e.position.set(this.x,this.y,this.z);var t=new THREE.CylinderGeometry(.01,.01,.01,1e4),r=new THREE.MeshLambertMaterial({color:"rgba(0, 122, 255, 1)",transparent:!0,opacity:.8}),n=new THREE.Mesh(t,r),i=this.createLabel();return n.add(i),n.position.set(-10,100,20),n.rotateX(Math.PI/2),e.add(n),e}},{key:"createLabel",value:function(){var e=document.createElement("div"),t=document.createElement("div");return t.className="text-img",e.className="text-label",e.appendChild(t),new THREE.CSS2DObject(e)}}]),e}(),y=function(){function e(t){u()(this,e),this.options=t,this.x=t.x,this.y=t.y,this.z=t.z,this.group=this.render()}return d()(e,[{key:"render",value:function(){var e=new THREE.Group;e.position.set(this.x,this.y,this.z);var t=new THREE.CylinderGeometry(.01,.01,.01,1e4),r=new THREE.MeshLambertMaterial({color:"rgba(0, 122, 255, 1)",transparent:!0,opacity:.8}),n=new THREE.Mesh(t,r),i=this.createLabel();return n.add(i),n.position.set(0,2,30),n.rotateX(Math.PI/2),e.add(n),e}},{key:"createLabel",value:function(){var e=document.createElement("div"),t='\n      <h3 class="name">'.concat(this.options.name,"</h3>\n    "),r=document.createElement("div");return r.className="text-name",r.innerHTML=t,e.className="text-outer-name",e.appendChild(r),new THREE.CSS2DObject(e)}}]),e}(),g=function(){function e(t){u()(this,e),this.options=t,this.x=t.x,this.z=t.z,this.y=t.y,this.width=t.width,this.length=t.length,this.height=t.height,this.name=t.name,this.resource_id=t.resource_id,this.build()}return d()(e,[{key:"build",value:function(){var e=this;this.group=new THREE.Group,this.group.resource_id=this.resource_id,this.group.position.set(this.x,this.y,this.z),this.group.name=this.name;var t=this.bottomBoard();this.group.add(t);var r=this.rightSide();this.group.add(r);var n=this.leftSide();this.group.add(n);var i=this.topBoard();this.group.add(i);var o=this.frontDoor();this.group.add(o);var a=this.backDoor();this.group.add(a);var s=this.smoke();this.group.add(s);var h=new y(this.options);if(this.group.add(h.group),this.options.first){var c=this.rope();this.group.add(c);var u=new m(this.options);this.group.add(u.group)}this.options[this.options.resource_id].length&&this.options[this.options.resource_id].forEach((function(t,r){e.addAsset(t)}))}},{key:"removeAsset",value:function(e){var t=this;e&&Array.isArray(e)&&e.forEach((function(e){t.group.children.forEach((function(r){r.hasOwnProperty("resource_id")&&r.resource_id===e&&t.group.remove(r)}))}))}},{key:"addAsset",value:function(e){var t=Number(e.u_height)+Number(e.start_u),r=Number(e.u_height),n=this.server(t,r,e.resource_id);this.group.add(n)}},{key:"topBoard",value:function(){var e=new THREE.Group;e.position.set(this.x,this.y,this.z),e.name="top-group";var t=new THREE.MeshLambertMaterial({transparent:!0,side:THREE.DoubleSide,opacity:1,map:this.gradientTexure(w)}),r=new THREE.BoxGeometry(this.width+4,2,this.length-1),n=[];n.push(t,t,new THREE.MeshLambertMaterial({transparent:!0,opacity:1,side:THREE.DoubleSide,map:this.gradientTexure(v)}),t,t,t);var i=new THREE.MeshFaceMaterial(n),o=new THREE.Mesh(r,i);return o.position.set(0,99,0),o.name="topBoard",e.add(o),e}},{key:"frontDoor",value:function(){var e=new THREE.Group;e.position.set(this.x+15,this.y,this.z+20),e.name="frontDoor-group";var t=new THREE.MeshLambertMaterial({color:f,transparent:!0,side:THREE.DoubleSide,opacity:.3,map:this.gradientTexure(w)}),r=new THREE.BoxGeometry(this.width+4,this.height,2),n=[];n.push(t,t,t,t,new THREE.MeshLambertMaterial({map:this.gradientTexure(w),transparent:!0,opacity:.2,side:THREE.DoubleSide}),new THREE.MeshLambertMaterial({map:this.gradientTexure(w),transparent:!0,opacity:.5,side:THREE.DoubleSide}));var i=new THREE.MeshFaceMaterial(n),o=new THREE.Mesh(r,i);return o.name="front-door",o.position.set(-this.width/2,50,0),e.add(o),e}},{key:"backDoor",value:function(){var e=new THREE.Group;e.position.set(this.x-15,this.y,this.z-20),e.name="backDoor-group";var t=new THREE.MeshLambertMaterial({color:31487,transparent:!0,side:THREE.DoubleSide,opacity:1,map:this.gradientTexure(w)}),r=new THREE.BoxGeometry(this.width+4,this.height,2),n=[];n.push(t,t,t,t,new THREE.MeshLambertMaterial({map:this.gradientTexure(w),transparent:!0,opacity:.2,side:THREE.DoubleSide}),t);var i=new THREE.MeshFaceMaterial(n),o=new THREE.Mesh(r,i);return o.name="back-door",o.position.set(this.width/2,50,0),e.add(o),e}},{key:"rightSide",value:function(){var e=new THREE.Group;e.position.set(this.x,this.y,this.z),e.name="right-group";var t=new THREE.MeshLambertMaterial({color:f,transparent:!0,side:THREE.DoubleSide,opacity:1,map:this.gradientTexure(w)}),r=new THREE.BoxGeometry(2,this.height,this.length),n=[];n.push(t,t,t,t,new THREE.MeshBasicMaterial({color:w,transparent:!0,side:THREE.DoubleSide,opacity:.5}),t);var i=new THREE.MeshFaceMaterial(n),o=new THREE.Mesh(r,i);return o.position.set(this.width/2+1,50,0),e.add(o),e}},{key:"leftSide",value:function(){var e=new THREE.Group;e.position.set(this.x,this.y,this.z),e.name="left-group";var t=new THREE.MeshLambertMaterial({color:f,transparent:!0,side:THREE.DoubleSide,opacity:1,map:this.gradientTexure(w)}),r=new THREE.BoxGeometry(2,this.height,this.length),n=[];n.push(t,t,t,t,new THREE.MeshBasicMaterial({color:5159679,transparent:!0,side:THREE.DoubleSide,opacity:.5}),t);var i=new THREE.MeshFaceMaterial(n),o=new THREE.Mesh(r,i);return o.position.set(-this.width/2-1,50,0),e.add(o),e}},{key:"bottomBoard",value:function(){var e=new THREE.Group;e.position.set(this.x,this.y,this.z),e.name="bottom-group";var t=new THREE.MeshBasicMaterial({color:31487,transparent:!0,side:THREE.DoubleSide,opacity:.4}),r=new THREE.BoxGeometry(this.width+4,2,this.length),n=new THREE.Mesh(r,t);return n.position.set(0,1,0),n.name="bottomBoard",e.add(n),e}},{key:"rope",value:function(){var e=new THREE.Group;e.position.set(this.x,this.y+2.5,this.z);var t=new THREE.MeshBasicMaterial({color:5159679}),r=new THREE.Vector3(-12,0,18.5),n=new THREE.Vector3(-12,0,-17),i=new THREE.Vector3(12,0,-17),o=new THREE.Vector3(12,0,18.5),a=new THREE.LineCurve3(r,n),s=new THREE.CatmullRomCurve3([n,i]),h=new THREE.LineCurve3(i,o),c=new THREE.CurvePath;c.curves.push(a,s,h);var u=new THREE.TubeGeometry(c,200,.2,25,!0),l=new THREE.Mesh(u,t);return e.add(l),e}},{key:"smoke",value:function(){var e=new THREE.Group;e.position.set(this.x,this.y,this.z);var t=new THREE.LineBasicMaterial({color:31487}),r=new THREE.LineBasicMaterial({color:31487}),n=new THREE.CylinderGeometry(4,4,1,25),i=new THREE.CylinderGeometry(3,0,1,25),o=new THREE.Mesh(n,t),a=new THREE.Mesh(i,r);return o.position.set(0,this.height-2,0),a.position.set(0,this.height-3,0),e.add(o),e.add(a),e}},{key:"server",value:function(e,t,r){var n=new THREE.Group;n.position.set(this.x,this.y,this.z);var i=new THREE.BoxGeometry(30,t-.2,40),o=new THREE.MeshBasicMaterial({color:5159679,opacity:.7,transparent:!0,side:THREE.DoubleSide}),a=new THREE.Mesh(i,o);return a.position.set(0,e-.1,0),a.name="server",n.add(a),n.resource_id=r,n}},{key:"switchs",value:function(e,t,r){var n=new THREE.Group;n.position.set(this.x,this.y,this.z);var i=new THREE.BoxGeometry(30,t,40),o=new THREE.MeshBasicMaterial({color:5159679,opacity:.4,transparent:!0,side:THREE.DoubleSide}),a=new THREE.Mesh(i,o);return a.name="switch",n.resource_id=r,a.position.set(0,e,0),n.add(a),n}},{key:"renderServerAndSwitch",value:function(e,t){}},{key:"gradientTexure",value:function(){var e=document.createElement("canvas");e.width=256,e.height=1024;var t=e.getContext("2d"),r=t.createLinearGradient(0,1024,1024,0);r.addColorStop(0,"rgba(0,0,0, 0)"),r.addColorStop(.68,"rgba(0,122,255,1)"),r.addColorStop(.7,"rgba(0,0,0, 0)"),r.addColorStop(1,"rgba(0,122,255,1)"),t.fillStyle=r,t.fillRect(0,0,256,1024);var n=new THREE.Texture(e);return n.needsUpdate=!0,n}}]),e}();function T(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function R(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?T(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function b(e,t,r){return{Is:new E(null,!1)}}var H={x:0,y:0,z:0,name:"",resource_id:"",width:30,length:40,height:100},x=[],M=null,k={};function L(e){var t=[];for(var r in e){var n=x[k[r]];if(!n)return;var i=e[r].map((function(e){return e.resource_id})),o=n.options.childIDs.split(",").filter((function(e){return!!e}));o.forEach((function(e){-1==i.indexOf(e)&&t(e)})),e[r].forEach((function(e){-1==o.indexOf(e.resource_id)&&n.addAsset(e)})),n.removeAsset(t)}}function S(e){var t=[];return $.ajax({url:e,type:"GET",async:!1,contentType:"*/*;charset=UTF-8",processData:!1,success:function(e){t=e},error:function(e){console.error(e)}}),t}function O(e){var t=[];return $.ajax({url:e,type:"GET",async:!1,contentType:"*/*;charset=UTF-8",processData:!1,success:function(e){t=e},error:function(e){console.error(e)}}),t}function _(e,t){var r=[],n={};if(e&&e.hasOwnProperty("racks")&&Array.isArray(e.racks)&&t&&t.hasOwnProperty("rows")&&Array.isArray(t.rows)){var i=e.racks.length,o=-18*Math.round(i/2)+(i%2==0?9:18);e.racks.forEach((function(e,t){delete e.free_u;var i=Object.assign({},H,e,{x:o+18*t});n[i.resource_id]=t,i.resource_id=e.resource_id,i[i.resource_id]=[],i.childIDs="",r.push(i)})),t.rows.forEach((function(e){var t=n[e.rack_id];r[t][e.rack_id].push(e),r[t].childIDs+=e.resource_id+","})),console.log("cabinetSettings",r)}return r}window.onload=h()(i.a.mark((function e(){var t,r,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return $(".loading").show(),e.next=3,S("/api/v2/mblock/asset/allrack");case 3:return t=e.sent,e.next=6,O("/api/v2/mblock/asset/list");case 6:r=e.sent,n=_(t,r),$(".loading").hide(),p=b(),n.forEach((function(e,t){var r=new g(R({first:0==t},e));x.push(r),k[r.resource_id]=t,p.Is.scene.add(r.group)})),(M=new Worker("./js/server.worker.js")).postMessage("start"),M.onmessage=function(e){var t=JSON.parse(e.data);t&&L(t)};case 14:case"end":return e.stop()}}),e)}))),window.onbeforeunload=function(){p.Is.destroyed(),M.postMessage("close"),M.terminate(),x=null,M=null,k=null,H=null,p=null};t.default=b}],[[6,1]]]);