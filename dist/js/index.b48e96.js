(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function i(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}},function(e,t,i){"use strict";i.r(t);var n=i(0),r=i.n(n),a=i(1),s=i.n(a);var o,h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;r()(this,e),console.log("initial Scene."),this.container=t?document.querySelector(t):null,this.width=this.container?this.container.offsetWidth:window.innerWidth,this.height=this.container?this.container.offsetHeight:window.innerHeight,this.dev=i,this.scene=new THREE.Scene,this.scene.position.set(0,-50,0),this.camera=this.initCamera(n),this.rotateY=(new THREE.Matrix4).makeRotationY(.005),this.initLight(),this.initRenderer(),this.initTexture(),this.initFloor(n),i&&(this.stats(),this.AxesHelper=new THREE.AxesHelper(300),this.AxesHelper.position.set(0,0,0),this.scene.add(this.AxesHelper)),this.render(),this.initControls(),this.animationID=this.animate(),window.addEventListener("resize",this.onResize.bind(this),!1),window.addEventListener("dblclick",this.injectHandler.bind(this,a),!1)}return s()(e,[{key:"initCamera",value:function(e){var t=new THREE.PerspectiveCamera(50,this.width/this.height,1,1e4);return t.position.set(0,15,200),t.lookAt(this.scene.position),t.updateMatrix(),t}},{key:"initLight",value:function(){this.dircLight=new THREE.DirectionalLight(16777215),this.dircLight.position.set(300,400,200),this.scene.add(this.dircLight);var e=new THREE.HemisphereLight(12403,169879,.75);e.position.set(.5,1,.75),this.scene.add(e)}},{key:"initFloor",value:function(e){var t=new THREE.BoxGeometry(300,0,250),i=new THREE.MeshLambertMaterial({color:16777215,map:this.floorTexture,transparent:!0});this.floor=new THREE.Mesh(t,i),this.floor.position.set(0,-1,10),this.scene.add(this.floor)}},{key:"initTexture",value:function(){var e,t,i=this;this.floorTexture=(e="images/floor.png",t=function(){i.render()},(new THREE.TextureLoader).load(e,()=>{t()})),this.floorTexture.wrapS=THREE.RepeatWrapping,this.floorTexture.wrapT=THREE.RepeatWrapping,this.floorTexture.repeat.set(1,1)}},{key:"initRenderer",value:function(){this.renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!0}),this.renderer.setSize(this.width,this.height),this.renderer.setClearColor(15658734,0),this.container?this.container.appendChild(this.renderer.domElement):document.body.appendChild(this.renderer.domElement),this.labelRenderer=new THREE.CSS2DRenderer,this.labelRenderer.setSize(this.width,this.height),this.labelRenderer.domElement.style.position="absolute",this.labelRenderer.domElement.style.top=0,this.container?this.container.appendChild(this.labelRenderer.domElement):document.body.appendChild(this.labelRenderer.domElement)}},{key:"initWave",value:function(){for(var e=2*Math.PI,t=new THREE.PointCloudMaterial({color:"#0063f5",program:function(t){t.beginPath(),t.arc(0,0,16,0,e),t.fill()}}),i=0,n=0;n<this.AMOUNTX;n++)for(var r=0;r<this.AMOUNTY;r++)this.particle=this.particles[i++]=new THREE.Sprite(t),this.particle.position.x=n*this.SEPARATION-this.AMOUNTX*this.SEPARATION/2,this.particle.position.z=r*this.SEPARATION-this.AMOUNTY*this.SEPARATION/2,this.scene.add(this.particle)}},{key:"render",value:function(){TWEEN.update(),this.camera.applyMatrix4(this.rotateY),this.renderer.render(this.scene,this.camera),this.labelRenderer.render(this.scene,this.camera)}},{key:"initControls",value:function(){this.controls=new THREE.OrbitControls(this.camera),this.controls.addEventListener("change",this.render.bind(this)),this.controls.maxDistance=2e3,this.controls.maxPolarAngle=1.5,this.controls.minPolarAngle=.5,this.controls.enableZoom=!1}},{key:"onResize",value:function(){var e=this.container?this.container.offsetWidth:window.innerWidth,t=this.container?this.container.offsetHeight:window.innerHeight;this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t),this.labelRenderer.render(this.scene,this.camera),this.labelRenderer.setSize(e,t)}},{key:"stats",value:function(){this.stats=new Stats,this.container?this.container.appendChild(this.stats.dom):document.body.appendChild(this.stats.dom)}},{key:"animate",value:function(){return this.render(),this.dev&&this.stats.update(),requestAnimationFrame(this.animate.bind(this))}},{key:"injectHandler",value:function(e,t){var i=window.innerWidth,n=window.innerHeight;t.preventDefault();var r=new THREE.Vector3(t.clientX/i*2-1,-t.clientY/n*2+1,.5);r=r.unproject(this.camera);var a=new THREE.Raycaster(this.camera.position,r.sub(this.camera.position).normalize()).intersectObjects(this.scene.children,!0)[0].object;e&&e instanceof Function&&e(a.parent),"front-door"===a.name&&(0==a.parent.rotation.y?new TWEEN.Tween(a.parent.rotation).to({y:.6*Math.PI},1500).easing(TWEEN.Easing.Elastic.Out).start():new TWEEN.Tween(a.parent.rotation).to({y:0},300).start(),this.controls.update()),"back-door"===a.name&&(0==a.parent.rotation.y?new TWEEN.Tween(a.parent.rotation).to({y:.6*Math.PI},1500).easing(TWEEN.Easing.Elastic.Out).start():new TWEEN.Tween(a.parent.rotation).to({y:0},300).start(),this.controls.update()),"server"!==a.name&&"switch"!==a.name||(0===a.parent.position.z?new TWEEN.Tween(a.parent.position).to({z:a.parent.position.z+30},500).easing(TWEEN.Easing.Elastic.Out).start():new TWEEN.Tween(a.parent.position).to({z:a.parent.position.z-30},500).easing(TWEEN.Easing.Elastic.Out).start(),this.controls.update()),this.render()}},{key:"destroyed",value:function(){window.cancelAnimationFrame(this.animationID),this.animationID=null,this.scene=null,this.camera=null,this.particle=null,this.particles=[],this.dircLight=null,this.dev=null,this.controls=null,window.removeEventListener("resize",(function(){})),window.removeEventListener("dblclick",(function(){})),this.container?(this.container.removeChild(this.renderer.domElement),this.container.removeChild(this.labelRenderer.domElement)):(document.body.removeChild(this.renderer.domElement),document.body.removeChild(this.labelRenderer.domElement)),this.container=null,this.renderer=null,this.labelRenderer=null}}]),e}(),d=31487,l="rgba(255, 108, 108, 1)",E="rgba(0, 122, 255, 1)",c=function(){function e(t){r()(this,e),this.options=t,this.x=t.x,this.y=t.y,this.z=t.z,this.group=this.render()}return s()(e,[{key:"render",value:function(){var e=new THREE.Group;e.position.set(this.x,this.y,this.z);var t=new THREE.CylinderGeometry(.01,.01,.01,1e4),i=new THREE.MeshLambertMaterial({color:"rgba(0, 122, 255, 1)",transparent:!0,opacity:.8}),n=new THREE.Mesh(t,i),r=this.createLabel();return n.add(r),n.position.set(-10,100,20),n.rotateX(Math.PI/2),e.add(n),e}},{key:"createLabel",value:function(){var e=document.createElement("div"),t=document.createElement("div");return t.className="text-img",e.className="text-label",e.appendChild(t),new THREE.CSS2DObject(e)}}]),e}(),u=function(){function e(t){r()(this,e),this.options=t,this.x=t.x,this.y=t.y,this.z=t.z,this.group=this.render()}return s()(e,[{key:"render",value:function(){var e=new THREE.Group;e.position.set(this.x,this.y,this.z);var t=new THREE.CylinderGeometry(.01,.01,.01,1e4),i=new THREE.MeshLambertMaterial({color:"rgba(0, 122, 255, 1)",transparent:!0,opacity:.8}),n=new THREE.Mesh(t,i),r=this.createLabel();return n.add(r),n.position.set(0,2,30),n.rotateX(Math.PI/2),e.add(n),e}},{key:"createLabel",value:function(){var e=document.createElement("div"),t='\n      <h3 class="name">'.concat(this.options.name,"</h3>\n    "),i=document.createElement("div");return i.className="text-name",i.innerHTML=t,e.className="text-outer-name",e.appendChild(i),new THREE.CSS2DObject(e)}}]),e}(),p=function(){function e(t){r()(this,e),this.options=t,this.x=t.x,this.z=t.z,this.y=t.y,this.width=t.width,this.length=t.length,this.height=t.height,this.name=t.name,this.resource_id=t.id,this.build()}return s()(e,[{key:"build",value:function(){this.group=new THREE.Group,this.group.position.set(this.x,this.y,this.z),this.group.name=this.name;var e=this.bottomBoard();this.group.add(e);var t=this.rightSide();this.group.add(t);var i=this.leftSide();this.group.add(i);var n=this.topBoard();this.group.add(n);var r=this.frontDoor();this.group.add(r);var a=this.backDoor();this.group.add(a);var s=this.rope();this.group.add(s);var o=this.smoke();this.group.add(o);var h=new u(this.options);this.group.add(h.group);var d=new c(this.options);this.group.add(d.group);for(var l=0;l<12;l++){var E=24+6*l,p=this.server(E,2);this.group.add(p)}var w=this.switchs(8,8);this.group.add(w);var m=this.switchs(18,6);this.group.add(m)}},{key:"topBoard",value:function(){var e=new THREE.Group;e.position.set(this.x,this.y,this.z),e.name="top-group";var t=new THREE.MeshLambertMaterial({transparent:!0,side:THREE.DoubleSide,opacity:1,map:this.gradientTexure(E)}),i=new THREE.BoxGeometry(this.width+4,2,this.length-1),n=[];n.push(t,t,new THREE.MeshLambertMaterial({transparent:!0,opacity:1,side:THREE.DoubleSide,map:this.gradientTexure(l)}),t,t,t);var r=new THREE.MeshFaceMaterial(n),a=new THREE.Mesh(i,r);return a.position.set(0,99,0),a.name="topBoard",e.add(a),e}},{key:"frontDoor",value:function(){var e=new THREE.Group;e.position.set(this.x+15,this.y,this.z+20),e.name="frontDoor-group";var t=new THREE.MeshLambertMaterial({color:d,transparent:!0,side:THREE.DoubleSide,opacity:.3,map:this.gradientTexure(E)}),i=new THREE.BoxGeometry(this.width+4,this.height,2),n=[];n.push(t,t,t,t,new THREE.MeshLambertMaterial({map:this.gradientTexure(E),transparent:!0,opacity:.2,side:THREE.DoubleSide}),new THREE.MeshLambertMaterial({map:this.gradientTexure(E),transparent:!0,opacity:.5,side:THREE.DoubleSide}));var r=new THREE.MeshFaceMaterial(n),a=new THREE.Mesh(i,r);return a.name="front-door",a.position.set(-this.width/2,50,0),e.add(a),e}},{key:"backDoor",value:function(){var e=new THREE.Group;e.position.set(this.x-15,this.y,this.z-20),e.name="backDoor-group";var t=new THREE.MeshLambertMaterial({color:31487,transparent:!0,side:THREE.DoubleSide,opacity:1,map:this.gradientTexure(E)}),i=new THREE.BoxGeometry(this.width+4,this.height,2),n=[];n.push(t,t,t,t,new THREE.MeshLambertMaterial({map:this.gradientTexure(E),transparent:!0,opacity:.2,side:THREE.DoubleSide}),t);var r=new THREE.MeshFaceMaterial(n),a=new THREE.Mesh(i,r);return a.name="back-door",a.position.set(this.width/2,50,0),e.add(a),e}},{key:"rightSide",value:function(){var e=new THREE.Group;e.position.set(this.x,this.y,this.z),e.name="right-group";var t=new THREE.MeshLambertMaterial({color:d,transparent:!0,side:THREE.DoubleSide,opacity:1,map:this.gradientTexure(E)}),i=new THREE.BoxGeometry(2,this.height,this.length),n=[];n.push(t,t,t,t,new THREE.MeshBasicMaterial({color:E,transparent:!0,side:THREE.DoubleSide,opacity:.5}),t);var r=new THREE.MeshFaceMaterial(n),a=new THREE.Mesh(i,r);return a.position.set(this.width/2+1,50,0),e.add(a),e}},{key:"leftSide",value:function(){var e=new THREE.Group;e.position.set(this.x,this.y,this.z),e.name="left-group";var t=new THREE.MeshLambertMaterial({color:d,transparent:!0,side:THREE.DoubleSide,opacity:1,map:this.gradientTexure(E)}),i=new THREE.BoxGeometry(2,this.height,this.length),n=[];n.push(t,t,t,t,new THREE.MeshBasicMaterial({color:5159679,transparent:!0,side:THREE.DoubleSide,opacity:.5}),t);var r=new THREE.MeshFaceMaterial(n),a=new THREE.Mesh(i,r);return a.position.set(-this.width/2-1,50,0),e.add(a),e}},{key:"bottomBoard",value:function(){var e=new THREE.Group;e.position.set(this.x,this.y,this.z),e.name="bottom-group";var t=new THREE.MeshBasicMaterial({color:31487,transparent:!0,side:THREE.DoubleSide,opacity:.4}),i=new THREE.BoxGeometry(this.width+4,2,this.length),n=new THREE.Mesh(i,t);return n.position.set(0,1,0),n.name="bottomBoard",e.add(n),e}},{key:"rope",value:function(){var e=new THREE.Group;e.position.set(this.x,this.y+2.5,this.z);var t=new THREE.MeshBasicMaterial({color:5159679}),i=new THREE.Vector3(-12,0,18.5),n=new THREE.Vector3(-12,0,-17),r=new THREE.Vector3(12,0,-17),a=new THREE.Vector3(12,0,18.5),s=new THREE.LineCurve3(i,n),o=new THREE.CatmullRomCurve3([n,r]),h=new THREE.LineCurve3(r,a),d=new THREE.CurvePath;d.curves.push(s,o,h);var l=new THREE.TubeGeometry(d,200,.2,25,!0),E=new THREE.Mesh(l,t);return e.add(E),e}},{key:"smoke",value:function(){var e=new THREE.Group;e.position.set(this.x,this.y,this.z);var t=new THREE.LineBasicMaterial({color:31487}),i=new THREE.LineBasicMaterial({color:31487}),n=new THREE.CylinderGeometry(4,4,1,25),r=new THREE.CylinderGeometry(3,0,1,25),a=new THREE.Mesh(n,t),s=new THREE.Mesh(r,i);return a.position.set(0,this.height-2,0),s.position.set(0,this.height-3,0),e.add(a),e.add(s),e}},{key:"server",value:function(e,t){var i=new THREE.Group;i.position.set(this.x,this.y,this.z);var n=new THREE.BoxGeometry(30,t,40),r=new THREE.MeshBasicMaterial({color:5159679,opacity:.7,transparent:!0,side:THREE.DoubleSide}),a=new THREE.Mesh(n,r);return a.position.set(0,e,0),a.name="server",i.add(a),i}},{key:"switchs",value:function(e,t){var i=new THREE.Group;i.position.set(this.x,this.y,this.z);var n=new THREE.BoxGeometry(30,t,40),r=new THREE.MeshBasicMaterial({color:5159679,opacity:.4,transparent:!0,side:THREE.DoubleSide}),a=new THREE.Mesh(n,r);return a.name="switch",a.position.set(0,e,0),i.add(a),i}},{key:"renderServerAndSwitch",value:function(e,t){}},{key:"gradientTexure",value:function(){var e=document.createElement("canvas");e.width=256,e.height=1024;var t=e.getContext("2d"),i=t.createLinearGradient(0,1024,1024,0);i.addColorStop(0,"rgba(0,0,0, 0)"),i.addColorStop(.68,"rgba(0,122,255,1)"),i.addColorStop(.7,"rgba(0,0,0, 0)"),i.addColorStop(1,"rgba(0,122,255,1)"),t.fillStyle=i,t.fillRect(0,0,256,1024);var n=new THREE.Texture(e);return n.needsUpdate=!0,n}}]),e}();function w(e,t,i){var n=new h(null,!1,3),r={x:0,y:0,z:0,name:"机柜",id:"0_528",width:30,length:40,height:100,server:{count:10,h:8,thickness:2},switch:{count:1,h:8,thickness:6}};r.name="机柜B",n.scene.add(new p(r).group);for(var a=1;a<Math.fround(1.5);a++)r.x=18*a,r.name="机柜C",n.scene.add(new p(r).group),r.x=-18*a,r.name="机柜A",n.scene.add(new p(r).group);return n}window.onload=function(){o=w()},window.onbeforeunload=function(){o.destroyed()};t.default=w}],[[2,1]]]);